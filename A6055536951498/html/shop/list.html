<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" type="text/css" href="../../css/api.css" />
    <link rel="stylesheet" type="text/css" href="../../css/common.css" />
    <link rel="stylesheet" type="text/css" href="../../css/shop.css" />
    <title>门店</title>
</head>
<body>
  <div id="header">
    <h1>
      <div class="cancel" tapmode="active" onclick="api.closeWin();"></div>
      门 店
    </h1>
  </div>
<!-- 条件筛选-->
<div id="condition">
    <div class="flex">
        <a href="javascript:;" class="select_part" data-type="district">
            <div class="select_part_structure border_r">
                <p class="mainIcon districtMark select_part_name">智能排序</p>
            </div>
            <div class="mainIcon right_down_arrow"></div>
        </a>
       	<a href="javascript:;" class="select_part" data-type="style">
			<div class="select_part_structure border_r">
          		<p class="mainIcon styleMark select_part_name">距离</p>
            </div>
            <div class="mainIcon right_down_arrow"></div>
        </a>
        <a href="javascript:;" class="select_part" data-type="order">
            <div class="select_part_structure border_r">
                <p class="mainIcon orderMark select_part_name">好评率</p>
            </div>
            <div class="mainIcon right_down_arrow"></div>
        </a>
        <a href="javascript:;" class="select_part" data-type="search">
            <div class="select_part_structure">
                <p class="mainIcon searchMark select_part_name">价格</p>
            </div>
            <div class="mainIcon right_down_arrow"></div>
        </a>
    </div>
</div>

<!-- 主题内容显示部分-->
<div id='wrapper' style="top:0px;bottom:0px;">
<div id="scroller-main">
	<div id = "scroller-pullDown" style="top:-4px;">
        <span id = "down-icon" class = "icon-double-angle-down pull-down-icon"></span>
		<span id = "pullDown-msg" class = "pull-down-msg"></span>
	</div>
    <input type="hidden" name="page" value="1">
    <ul class="merchant"></ul>
</div>
</div>
<script type="text/html" id="J-model-company">
    <li>
        <div tapmode="" onclick="openNewFrame('{{id}}')" class="shop_link flex">
            <div class="shop_face_img_part">
                <img data-original="{{background_url}}" class="shop_faceImg lazy" alt="">
            </div>
            <div class="shop_right">
                <p class="name"><span>{{name}}</span>{{company_lable}}</p>
                <div class="data_part">
                    <span class="score">评分：{{score}}</span>
                    <span class="project_count">工程数：{{project_count}}</span>
                </div>
                <div class="clearfix">
                	<p class="business">{{business}}</p>
                	<p class="product_type">{{product_lable1}} {{product_lable2}}</p>
                    <p class="mainIcon distance">{{distance}}</p>
                </div>
            </div>
        </div>
        <!--<div onclick="openWin('rule')" class="merchant_tag clearfix">
            {{is_honesty}}
            {{is_budget}}
            {{is_rights}}
            {{is_quality}}
        </div>-->
    </li>
</script>


<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/widget/jquery.js"></script>
<script type="text/javascript" src="../../script/global.js"></script>
<script type="text/javascript">
apiready = function() {
  glo.init();
  $api.post(website_zmz +'/mobile/merchant/index?zmz_source=apicloud', {
    body: {}
  }, function(ret) {
    glo.echo(ret);
    var companies = ret.companies;
    $.each(companies, function(i){
        var html = $api.html($api.byId('J-model-company'));
        html = toReplaceModel(html, companies[i]);
        $api.append($api.dom('.merchant'), html);
    });
  });
  function toReplaceModel (html, companies){
      html = html.replace("{{id}}", companies.id);
      html = html.replace("{{background_url}}", companies.background_url);
      html = html.replace("{{name}}", companies.name);
      html = html.replace("{{score}}", companies.score);
      html = html.replace("{{project_count}}", companies.project_count);
      html = html.replace("{{distance}}", companies.distance);
      html = html.replace("{{is_honesty}}", companies.is_honesty ? '<p class="bg_gray">赔</p>' : '');
      html = html.replace("{{is_budget}}", companies.is_budget ? '<p class="bg_cyan-blue">算</p>' : '');
      html = html.replace("{{is_rights}}", companies.is_rights ? '<p class="bg_green">维</p>' : '');
      html = html.replace("{{is_quality}}", companies.is_quality ? '<p class="bg_blue">云</p>' : '');
      html = html.replace("{{business}}", companies.business);
      html = html.replace("{{product_lable1}}", companies.product_lable1);
      html = html.replace("{{product_lable2}}", companies.product_lable2);
      if (companies.company_lable_id == '1')
        html = html.replace("{{company_lable}}", '<span class="company_lable_red">' + companies.company_lable + '</span>');
      else if(companies.company_lable_id == '2')
        html = html.replace("{{company_lable}}", '<span class="company_lable_orange">' + companies.company_lable + '</span>');
      else {
        html = html.replace("{{company_lable}}", '');
      }
      return html;
  }

}
</script>

</body>
</html>
